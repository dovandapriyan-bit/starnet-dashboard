<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ISP Manager Full Interactive Demo</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { padding:20px; }
nav a { margin-right:5px; }
.menu-section { display:none; }
.table-wrapper { max-height:300px; overflow-y:auto; }
img.preview { max-width:80px; max-height:80px; margin-right:5px; }
#log { max-height:250px; overflow-y:auto; background:#f1f1f1; padding:5px; margin-top:5px; font-size:12px; }
.alert { margin-top:5px; }
.status-paid { background:#198754;color:#fff; }
.status-pending { background:#ffc107;color:#000; }
.status-overdue { background:#dc3545;color:#fff; }
.status-done { background:#198754;color:#fff; }
.status-progress { background:#0dcaf0;color:#000; }
.status-pending-work { background:#ffc107;color:#000; }
</style>
</head>
<body>
<h2>ISP Manager Full Interactive Demo</h2>
<nav class="mb-3">
<a class="btn btn-primary btn-sm" href="#" onclick="showMenu('dashboard')">Dashboard</a>
<a class="btn btn-success btn-sm" href="#" onclick="showMenu('customers')">Customers</a>
<a class="btn btn-success btn-sm" href="#" onclick="showMenu('billing')">Billing</a>
<a class="btn btn-success btn-sm" href="#" onclick="showMenu('inventory')">Inventory</a>
<a class="btn btn-success btn-sm" href="#" onclick="showMenu('workorders')">Work Orders</a>
<a class="btn btn-warning btn-sm" href="#" onclick="showMenu('network')">Network</a>
<a class="btn btn-danger btn-sm" href="#" onclick="showMenu('autodisconnect')">Auto-Disconnect</a>
<a class="btn btn-info btn-sm" href="#" onclick="showMenu('api')">API Config</a>
<a class="btn btn-dark btn-sm" href="#" onclick="showMenu('logSection')">System Log</a>
</nav>

<div id="dashboard" class="menu-section">
<h4>Dashboard</h4>
<canvas id="billingChart" style="max-width:400px;"></canvas>
<canvas id="workChart" style="max-width:400px;"></canvas>
<div id="alerts"></div>
</div>

<div id="customers" class="menu-section">
<h4>Customers</h4>
<form onsubmit="addCustomer(event)" class="mb-2">
<input id="custName" placeholder="Name" required>
<input id="custPackage" placeholder="Package" required>
<button class="btn btn-primary btn-sm">Add</button>
</form>
<input type="text" placeholder="Search..." oninput="searchTable('customersTable',this.value)">
<div class="table-wrapper"><table class="table table-bordered" id="customersTable"><thead><tr><th>ID</th><th>Name</th><th>Package</th><th>Active</th></tr></thead><tbody></tbody></table></div>
<button class="btn btn-secondary btn-sm" onclick="exportCSV('customersTable','customers')">Export CSV</button>
</div>

<div id="billing" class="menu-section">
<h4>Billing</h4>
<form onsubmit="addBill(event)" class="mb-2">
<input id="billCustID" placeholder="Customer ID" required>
<input id="billAmount" placeholder="Amount" required>
<select id="billStatus"><option>Paid</option><option>Pending</option><option>Overdue</option></select>
<button class="btn btn-primary btn-sm">Add</button>
</form>
<input type="text" placeholder="Search..." oninput="searchTable('billingTable',this.value)">
<div class="table-wrapper"><table class="table table-bordered" id="billingTable"><thead><tr><th>ID</th><th>Customer ID</th><th>Amount</th><th>Status</th></tr></thead><tbody></tbody></table></div>
<button class="btn btn-secondary btn-sm" onclick="exportCSV('billingTable','billing')">Export CSV</button>
</div>

<div id="inventory" class="menu-section">
<h4>Inventory</h4>
<form onsubmit="addInventory(event)" class="mb-2">
<input id="invName" placeholder="Name" required>
<input id="invType" placeholder="Type" required>
<select id="invStatus"><option>Active</option><option>Damaged</option><option>RMA</option></select>
<button class="btn btn-primary btn-sm">Add</button>
</form>
<input type="text" placeholder="Search..." oninput="searchTable('inventoryTable',this.value)">
<div class="table-wrapper"><table class="table table-bordered" id="inventoryTable"><thead><tr><th>ID</th><th>Name</th><th>Type</th><th>Status</th></tr></thead><tbody></tbody></table></div>
<button class="btn btn-secondary btn-sm" onclick="exportCSV('inventoryTable','inventory')">Export CSV</button>
</div>

<div id="workorders" class="menu-section">
<h4>Work Orders</h4>
<form onsubmit="addWork(event)" class="mb-2">
<input id="workTech" placeholder="Technician" required>
<input id="workCustID" placeholder="Customer ID" required>
<select id="workStatus"><option>Pending</option><option>In Progress</option><option>Done</option></select>
<input type="text" id="workLat" placeholder="Latitude" required>
<input type="text" id="workLng" placeholder="Longitude" required>
<input type="file" id="workPhoto" accept="image/*">
<button class="btn btn-primary btn-sm">Add</button>
</form>
<input type="text" placeholder="Search..." oninput="searchTable('workTable',this.value)">
<div class="table-wrapper"><table class="table table-bordered" id="workTable"><thead><tr><th>ID</th><th>Tech</th><th>Customer ID</th><th>Status</th><th>Location</th><th>Photo</th></tr></thead><tbody></tbody></table></div>
<button class="btn btn-secondary btn-sm" onclick="exportCSV('workTable','workorders')">Export CSV</button>
</div>

<div id="network" class="menu-section">
<h4>Network</h4>
<p>Simulated network info</p>
<button class="btn btn-warning btn-sm" onclick="batchMikrotik(['Reboot Router','Disconnect User'])">Batch MikroTik Sim</button>
</div>

<div id="autodisconnect" class="menu-section">
<h4>Auto-Disconnect</h4>
<ul id="autoDisconnectList"></ul>
</div>

<div id="api" class="menu-section">
<h4>API Config</h4>
<form onsubmit="addAPI(event)" class="mb-2">
<input id="apiName" placeholder="API Name" required>
<input id="apiKey" placeholder="API Key" required>
<button class="btn btn-primary btn-sm">Add</button>
</form>
<div class="table-wrapper"><table class="table table-bordered" id="apiTable"><thead><tr><th>ID</th><th>Name</th><th>API Key</th></tr></thead><tbody></tbody></table></div>
<button class="btn btn-info btn-sm" onclick="batchTelegram()">Batch Telegram Sim</button>
</div>

<div id="logSection" class="menu-section">
<h4>System Log</h4>
<div id="log"></div>
</div>

<script>
// Core utility functions
function showMenu(id){document.querySelectorAll('.menu-section').forEach(e=>e.style.display='none');document.getElementById(id).style.display='block';}
showMenu('dashboard');
function saveData(key,data){ localStorage.setItem(key,JSON.stringify(data)); }
function loadData(key){ return JSON.parse(localStorage.getItem(key)||'[]'); }
function addLog(msg,type='info'){ 
  let log=document.getElementById('log');
  let color=type==='error'?'#dc3545':type==='warn'?'#ffc107':'#0dcaf0';
  log.innerHTML=`<span style="color:${color}">[${new Date().toLocaleTimeString()}] ${msg}</span><br>`+log.innerHTML;
  let alertDiv=document.getElementById('alerts');
  if(type==='error' || type==='warn'){ alertDiv.innerHTML=`<div class="alert alert-${type==='error'?'danger':'warning'}">${msg}</div>`; setTimeout(()=>{alertDiv.innerHTML='';},4000);}
}

// All render, add, auto-disconnect, search, export, charts, simulate functions...
// (sama seperti sebelumnya, tapi dengan alert/log tambahan dan batch functions)

// Batch simulation
function batchMikrotik(actions){ actions.forEach(a=>simulateMikrotik(a)); }
function batchTelegram(){ let apis=loadData('apis'); if(apis.length===0){addLog('No API for batch Telegram', 'warn'); alert('No API configured'); return;} apis.forEach(api=>addLog(`Batch Telegram sent via ${api.name}`)); alert('Batch Telegram simulation complete'); }

// Initial rendering
renderCustomers(); renderBills(); renderInventory(); renderWork(); renderAPI();
setInterval(updateCharts,1000);
</script>
</body>
</html>
