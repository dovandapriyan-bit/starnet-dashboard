<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ISP Manager - Final Fix</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body { background:#f4f6f9; }
    .sidebar { height:100vh; width:250px; position:fixed; top:0; left:-260px; background:#1a202c; color:#fff; transition:0.3s; overflow-y:auto; }
    .sidebar.active { left:0; }
    .sidebar a { color:#fff; display:block; padding:12px; text-decoration:none; }
    .sidebar a:hover { background:#2d3748; }
    .content { margin-left:0; transition:0.3s; padding:20px; }
    .content.active { margin-left:250px; }
    header { background:#2d3748; color:#fff; padding:10px; display:flex; align-items:center; }
    .hamburger { font-size:24px; cursor:pointer; margin-right:15px; }
    .card { border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.1); margin-bottom:20px; }
    .hidden { display:none; }
    table { width:100%; border-collapse:collapse; }
    th,td { border:1px solid #ccc; padding:8px; font-size:14px; }
    th { background:#edf2f7; }
    .btn-sm { margin:1px; }
    .status-open { background:#38a169; color:#fff; padding:3px 6px; border-radius:5px; }
    .status-close { background:#e53e3e; color:#fff; padding:3px 6px; border-radius:5px; }
    .status-pending { background:#d69e2e; color:#fff; padding:3px 6px; border-radius:5px; }
  </style>
</head>
<body>

<!-- LOGIN PAGE -->
<div id="loginPage" class="d-flex justify-content-center align-items-center" style="height:100vh;">
  <div class="card p-4" style="width:320px;">
    <h4 class="text-center mb-3">Login ISP Manager</h4>
    <input type="text" id="username" class="form-control mb-2" placeholder="Username">
    <input type="password" id="password" class="form-control mb-3" placeholder="Password">
    <button class="btn btn-primary w-100" onclick="login()">Login</button>
  </div>
</div>

<!-- DASHBOARD PAGE -->
<div id="dashboardPage" class="hidden">
  <header>
    <span class="hamburger" onclick="toggleSidebar()">â˜°</span>
    <h5>ISP Manager Dashboard</h5>
  </header>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <a href="#" onclick="showPage('dashboardHome')">Dashboard</a>
    <a href="#" onclick="showPage('pasangBaruPage')">Pasang Baru</a>
    <a href="#" onclick="showPage('gangguanPage')">Gangguan</a>
    <a href="#" onclick="showPage('pelangganPage')">Pelanggan</a>
    <a href="#" onclick="showPage('billingPage')">Billing</a>
    <a href="#" onclick="showPage('kasPage')">Kas</a>
    <a href="#" onclick="showPage('odpPage')">ODP</a>
    <a href="#" onclick="showPage('materialPage')">Material</a>
    <a href="#" onclick="showPage('portalPage')">Portal Pelanggan</a>
  </div>

  <!-- Content -->
  <div class="content" id="content">

    <!-- Dashboard Home -->
    <div id="dashboardHome" class="page">
      <div class="card p-3">
        <h5>Ringkasan Jaringan</h5>
        <p>Grafik, statistik & KPI di sini.</p>
      </div>
      <div class="card p-3">
        <h5>Feedback</h5>
        <p>Rating teknisi & catatan pelanggan.</p>
      </div>
    </div>

    <!-- PASANG BARU -->
    <div id="pasangBaruPage" class="page hidden">
      <div class="card p-3">
        <h5>Pasang Baru</h5>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Inputer</th>
              <th>Nama</th>
              <th>Alamat</th>
              <th>No HP</th>
              <th>Tagging Lokasi</th>
              <th>Paket</th>
              <th>Status</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="pasangBody"></tbody>
        </table>
        <button class="btn btn-primary" onclick="addPasang()">+ Tambah Pelanggan Baru</button>
      </div>
    </div>

    <!-- GANGGUAN -->
    <div id="gangguanPage" class="page hidden">
      <div class="card p-3">
        <h5>Data Gangguan</h5>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>No Internet</th>
              <th>Nama</th>
              <th>No HP</th>
              <th>Alamat</th>
              <th>Jenis Gangguan</th>
              <th>Status</th>
              <th>TTR</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="gangguanBody"></tbody>
        </table>
        <button class="btn btn-primary" onclick="addGangguan()">+ Tambah Gangguan</button>
      </div>
    </div>

    <!-- PELANGGAN -->
    <div id="pelangganPage" class="page hidden">
      <div class="card p-3">
        <h5>Data Pelanggan</h5>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>No Internet</th>
              <th>Nama</th>
              <th>Status Koneksi</th>
              <th>ODP</th>
              <th>SN ONT</th>
              <th>Tanggal Pasang</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="pelangganBody"></tbody>
        </table>
      </div>
    </div>

    <!-- BILLING -->
    <div id="billingPage" class="page hidden">
      <div class="card p-3">
        <h5>Billing</h5>
        <input type="text" id="searchBilling" class="form-control mb-2" placeholder="Cari No Internet / SN ONT">
        <button class="btn btn-success mb-2" onclick="generateBilling()">Generate Billing</button>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>No Internet</th>
              <th>Status Bayar</th>
              <th>Jumlah</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="billingBody"></tbody>
        </table>
      </div>
    </div>

    <!-- KAS -->
    <div id="kasPage" class="page hidden">
      <div class="card p-3">
        <h5>Kas</h5>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Keterangan</th>
              <th>Debit</th>
              <th>Kredit</th>
              <th>Saldo</th>
            </tr>
          </thead>
          <tbody id="kasBody"></tbody>
        </table>
      </div>
    </div>

    <!-- ODP -->
    <div id="odpPage" class="page hidden">
      <div class="card p-3">
        <h5>ODP</h5>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Nama ODP</th>
              <th>Kapasitas</th>
              <th>Feeder</th>
              <th>Distribusi</th>
              <th>Tagging Lokasi</th>
            </tr>
          </thead>
          <tbody id="odpBody"></tbody>
        </table>
      </div>
    </div>

    <!-- MATERIAL -->
    <div id="materialPage" class="page hidden">
      <div class="card p-3">
        <h5>Material</h5>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Jenis</th>
              <th>Qty</th>
              <th>Satuan</th>
              <th>Stock</th>
              <th>Log Pemakaian</th>
            </tr>
          </thead>
          <tbody id="materialBody"></tbody>
        </table>
      </div>
    </div>

    <!-- PORTAL PELANGGAN -->
    <div id="portalPage" class="page hidden">
      <div class="card p-3">
        <h5>Portal Pelanggan</h5>
        <p>History billing & gangguan pelanggan ini.</p>
      </div>
    </div>

  </div>
</div>

<script>
let currentUser="";
let gangguanData=[];
let pasangData=[];

function login(){
  let u=document.getElementById("username").value;
  let p=document.getElementById("password").value;
  if(u && p){
    currentUser=u;
    document.getElementById("loginPage").classList.add("hidden");
    document.getElementById("dashboardPage").classList.remove("hidden");
    showPage("dashboardHome");
  } else { alert("Isi username & password!"); }
}
function toggleSidebar(){
  document.getElementById("sidebar").classList.toggle("active");
  document.getElementById("content").classList.toggle("active");
}
function showPage(id){
  document.querySelectorAll(".page").forEach(pg=>pg.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

// === GANGGUAN ===
function renderGangguan(){
  let tbody=document.getElementById("gangguanBody");
  tbody.innerHTML="";
  gangguanData.forEach((g,i)=>{
    tbody.innerHTML+=`
      <tr>
        <td>${g.noInternet}</td><td>${g.nama}</td><td>${g.hp}</td><td>${g.alamat}</td>
        <td>${g.jenis}</td><td><span class="status-${g.status}">${g.status}</span></td>
        <td>${g.ttr}</td>
        <td>
          <button class="btn btn-sm btn-primary" onclick="sendToTeknisi(${i})">Kirim ke Teknisi</button>
          <button class="btn btn-sm btn-success" onclick="updateStatus(${i},'open')">Progres</button>
          <button class="btn btn-sm btn-warning" onclick="updateStatus(${i},'pending')">Pending</button>
          <button class="btn btn-sm btn-danger" onclick="updateStatus(${i},'close')">Close</button>
        </td>
      </tr>`;
  });
}
function addGangguan(){
  let g={noInternet:prompt("No Internet:"),nama:prompt("Nama:"),hp:prompt("HP:"),alamat:prompt("Alamat:"),jenis:prompt("Jenis Gangguan:"),status:"open",ttr:"0 jam"};
  gangguanData.push(g); renderGangguan();
}
function updateStatus(i,s){ gangguanData[i].status=s; renderGangguan(); }
function sendToTeknisi(i){
  let a=prompt("Teknisi: ketik 'terima' atau 'tolak'");
  if(a=="terima"){ gangguanData[i].status="open"; alert("Teknisi terima tiket"); }
  else if(a=="tolak"){ gangguanData[i].status="pending"; alert("Teknisi tolak tiket"); }
  renderGangguan();
}

// === PASANG BARU ===
function renderPasang(){
  let tbody=document.getElementById("pasangBody"); tbody.innerHTML="";
  pasangData.forEach((p,i)=>{
    tbody.innerHTML+=`
      <tr>
        <td>${p.inputer}</td><td>${p.nama}</td><td>${p.alamat}</td><td>${p.hp}</td>
        <td>${p.tagging}</td><td>${p.paket}</td>
        <td><span class="status-${p.status}">${p.status}</span></td>
        <td>
          <button class="btn btn-sm btn-primary" onclick="shareOrder(${i})">Share Order</button>
          <button class="btn btn-sm btn-success" onclick="updatePasang(${i},'progres')">Progres</button>
          <button class="btn btn-sm btn-info" onclick="updatePasang(${i},'active')">Active</button>
          <button class="btn btn-sm btn-dark" onclick="updatePasang(${i},'cancel')">Cancel</button>
        </td>
      </tr>`;
  });
}
function addPasang(){
  let p={inputer:currentUser,nama:prompt("Nama:"),alamat:prompt("Alamat:"),hp:prompt("HP:"),tagging:prompt("Tagging Lokasi:"),paket:prompt("Paket:"),status:"menunggu"};
  pasangData.push(p); renderPasang();
}
function updatePasang(i,s){ pasangData[i].status=s; renderPasang(); }
function shareOrder(i){
  let a=prompt("Teknisi: ketik 'terima' atau 'tolak'");
  if(a=="terima"){ pasangData[i].status="progres"; alert("Teknisi ambil order"); }
  else if(a=="tolak"){ pasangData[i].status="cancel"; alert("Teknisi tolak order"); }
  renderPasang();
}

// Billing, Pelanggan, Kas, ODP, Material masih dummy untuk struktur
</script>
</body>
</html>
