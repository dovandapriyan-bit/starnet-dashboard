<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ISP Manager - Final Fix</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#f4f6f9; }
    header { background:#2d3748; color:#fff; padding:10px; display:flex; align-items:center; }
    header h1 { flex:1; font-size:18px; }
    .hamburger { font-size:24px; cursor:pointer; }
    .sidebar { width:250px; background:#1a202c; color:#fff; height:100vh; position:fixed; top:0; left:-260px; transition:0.3s; overflow-y:auto; }
    .sidebar.active { left:0; }
    .sidebar a { display:block; padding:12px; color:#fff; text-decoration:none; }
    .sidebar a:hover { background:#2d3748; }
    .content { margin-left:0; padding:20px; transition:0.3s; }
    .content.active { margin-left:250px; }
    .card { background:#fff; padding:20px; border-radius:12px; margin-bottom:20px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .hidden { display:none; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th,td { border:1px solid #ccc; padding:8px; font-size:14px; }
    th { background:#edf2f7; }
    .btn { padding:5px 10px; border:none; border-radius:5px; cursor:pointer; margin:2px; }
    .btn-green { background:#38a169; color:#fff; }
    .btn-red { background:#e53e3e; color:#fff; }
    .btn-yellow { background:#d69e2e; color:#fff; }
    .btn-blue { background:#3182ce; color:#fff; }
    .status-open { color:#fff; background:#38a169; padding:3px 6px; border-radius:5px; }
    .status-close { color:#fff; background:#e53e3e; padding:3px 6px; border-radius:5px; }
    .status-pending { color:#fff; background:#d69e2e; padding:3px 6px; border-radius:5px; }
  </style>
</head>
<body>

<!-- LOGIN PAGE -->
<div id="loginPage">
  <div style="display:flex;justify-content:center;align-items:center;height:100vh;">
    <div class="card" style="width:300px;">
      <h2 style="text-align:center;">Login ISP Manager</h2>
      <input type="text" id="username" placeholder="Username" style="width:100%;padding:10px;margin:10px 0;">
      <input type="password" id="password" placeholder="Password" style="width:100%;padding:10px;margin:10px 0;">
      <button class="btn btn-blue" onclick="login()">Login</button>
    </div>
  </div>
</div>

<!-- DASHBOARD -->
<div id="dashboardPage" class="hidden">
  <header>
    <span class="hamburger" onclick="toggleSidebar()">â˜°</span>
    <h1>ISP Manager Dashboard</h1>
  </header>
  <div class="sidebar" id="sidebar">
    <a href="#" onclick="showPage('dashboardHome')">Dashboard</a>
    <a href="#" onclick="showPage('gangguanPage')">Gangguan</a>
    <a href="#" onclick="showPage('pasangBaruPage')">Pasang Baru</a>
    <a href="#" onclick="showPage('pelangganPage')">Pelanggan</a>
    <a href="#" onclick="showPage('billingPage')">Billing</a>
    <a href="#" onclick="showPage('kasPage')">Kas</a>
    <a href="#" onclick="showPage('odpPage')">ODP</a>
    <a href="#" onclick="showPage('materialPage')">Material</a>
    <a href="#" onclick="showPage('portalPage')">Portal Pelanggan</a>
  </div>
  <div class="content" id="content">
    <!-- Dashboard Home -->
    <div id="dashboardHome" class="page">
      <div class="card"><h3>Ringkasan Jaringan</h3><p>Grafik & KPI ditampilkan di sini.</p></div>
      <div class="card"><h3>Feedback</h3><p>Rating pelanggan & catatan teknisi.</p></div>
    </div>

    <!-- GANGGUAN PAGE -->
    <div id="gangguanPage" class="page hidden">
      <div class="card">
        <h3>Data Gangguan</h3>
        <table>
          <thead>
            <tr>
              <th>No Internet</th>
              <th>Nama Pelanggan</th>
              <th>No HP</th>
              <th>Alamat</th>
              <th>Jenis Gangguan</th>
              <th>Status</th>
              <th>TTR</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="gangguanBody"></tbody>
        </table>
        <button class="btn btn-blue" onclick="addGangguan()">+ Tambah Gangguan</button>
      </div>
    </div>

    <!-- PASANG BARU PAGE -->
    <div id="pasangBaruPage" class="page hidden">
      <div class="card">
        <h3>Pasang Baru</h3>
        <table>
          <thead>
            <tr>
              <th>Inputer</th>
              <th>Nama</th>
              <th>Alamat</th>
              <th>No HP</th>
              <th>Tagging Lokasi</th>
              <th>Paket</th>
              <th>Status</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="pasangBody"></tbody>
        </table>
        <button class="btn btn-blue" onclick="addPasang()">+ Tambah Pelanggan Baru</button>
      </div>
    </div>

    <!-- PELANGGAN PAGE -->
    <div id="pelangganPage" class="page hidden">
      <div class="card">
        <h3>Data Pelanggan</h3>
        <table>
          <thead>
            <tr>
              <th>No Internet</th>
              <th>Nama</th>
              <th>Status Koneksi</th>
              <th>ODP</th>
              <th>SN ONT</th>
              <th>Tanggal Pasang</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="pelangganBody"></tbody>
        </table>
      </div>
    </div>

    <!-- BILLING PAGE -->
    <div id="billingPage" class="page hidden">
      <div class="card">
        <h3>Billing</h3>
        <input type="text" id="searchBilling" placeholder="Cari No Internet / SN ONT">
        <button class="btn btn-blue" onclick="generateBilling()">Generate Billing</button>
        <table>
          <thead>
            <tr>
              <th>No Internet</th>
              <th>Status Bayar</th>
              <th>Jumlah</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody id="billingBody"></tbody>
        </table>
      </div>
    </div>

    <!-- KAS PAGE -->
    <div id="kasPage" class="page hidden">
      <div class="card">
        <h3>Kas</h3>
        <table>
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Keterangan</th>
              <th>Debit</th>
              <th>Kredit</th>
              <th>Saldo</th>
            </tr>
          </thead>
          <tbody id="kasBody"></tbody>
        </table>
      </div>
    </div>

    <!-- ODP PAGE -->
    <div id="odpPage" class="page hidden">
      <div class="card">
        <h3>ODP</h3>
        <table>
          <thead>
            <tr>
              <th>Nama ODP</th>
              <th>Kapasitas</th>
              <th>Feeder</th>
              <th>Distribusi</th>
              <th>Tagging Lokasi</th>
            </tr>
          </thead>
          <tbody id="odpBody"></tbody>
        </table>
      </div>
    </div>

    <!-- MATERIAL PAGE -->
    <div id="materialPage" class="page hidden">
      <div class="card">
        <h3>Material</h3>
        <table>
          <thead>
            <tr>
              <th>Jenis</th>
              <th>Qty</th>
              <th>Satuan</th>
              <th>Stock</th>
              <th>Log Pemakaian</th>
            </tr>
          </thead>
          <tbody id="materialBody"></tbody>
        </table>
      </div>
    </div>

    <!-- PORTAL PELANGGAN -->
    <div id="portalPage" class="page hidden">
      <div class="card">
        <h3>Portal Pelanggan</h3>
        <p>Menampilkan hanya gangguan & billing pelanggan login ini.</p>
      </div>
    </div>
  </div>
</div>

<script>
let currentUser = "";
let gangguanData = [];
let pasangData = [];

// === LOGIN FUNCTION ===
function login() {
  let user = document.getElementById("username").value;
  let pass = document.getElementById("password").value;
  if(user && pass){
    currentUser = user;
    document.getElementById("loginPage").classList.add("hidden");
    document.getElementById("dashboardPage").classList.remove("hidden");
    showPage('dashboardHome');
  } else {
    alert("Isi username & password!");
  }
}

// === TOGGLE SIDEBAR ===
function toggleSidebar(){
  document.getElementById("sidebar").classList.toggle("active");
  document.getElementById("content").classList.toggle("active");
}

// === PAGE SWITCH ===
function showPage(pageId){
  let pages = document.getElementsByClassName("page");
  for(let i=0;i<pages.length;i++){ pages[i].classList.add("hidden"); }
  document.getElementById(pageId).classList.remove("hidden");
}

// === GANGGUAN FUNCTIONS ===
function renderGangguan(){
  let tbody = document.getElementById("gangguanBody");
  tbody.innerHTML = "";
  gangguanData.forEach((g,i)=>{
    tbody.innerHTML += `
      <tr>
        <td>${g.noInternet}</td>
        <td>${g.nama}</td>
        <td>${g.hp}</td>
        <td>${g.alamat}</td>
        <td>${g.jenis}</td>
        <td><span class="status-${g.status}">${g.status}</span></td>
        <td>${g.ttr}</td>
        <td>
          <button class="btn btn-blue" onclick="sendToTeknisi(${i})">Kirim WA Teknisi</button>
          <button class="btn btn-green" onclick="updateStatus(${i},'open')">Progres</button>
          <button class="btn btn-yellow" onclick="updateStatus(${i},'pending')">Pending</button>
          <button class="btn btn-red" onclick="updateStatus(${i},'close')">Close</button>
        </td>
      </tr>`;
  });
}

function addGangguan(){
  let noInternet = prompt("Masukkan No Internet:");
  let nama = prompt("Masukkan Nama Pelanggan:");
  let hp = prompt("Masukkan No HP:");
  let alamat = prompt("Masukkan Alamat:");
  let jenis = prompt("Masukkan Jenis Gangguan:");
  let g = {noInternet,nama,hp,alamat,jenis,status:"open",ttr:"0 Jam"};
  gangguanData.push(g);
  renderGangguan();
}

function updateStatus(i,status){
  gangguanData[i].status = status;
  renderGangguan();
}

function sendToTeknisi(i){
  let action = prompt("Teknisi: Ketik 'terima' untuk ambil tiket, 'tolak' untuk menolak:");
  if(action=="terima"){ gangguanData[i].status = "open"; }
  else if(action=="tolak"){ gangguanData[i].status = "pending"; }
  renderGangguan();
}

// === PASANG BARU ===
function renderPasang(){
  let tbody = document.getElementById("pasangBody");
  tbody.innerHTML = "";
  pasangData.forEach((p,i)=>{
    tbody.innerHTML += `
      <tr>
        <td>${p.inputer}</td>
        <td>${p.nama}</td>
        <td>${p.alamat}</td>
        <td>${p.hp}</td>
        <td>${p.tagging}</td>
        <td>${p.paket}</td>
        <td><span class="status-${p.status}">${p.status}</span></td>
        <td>
          <button class="btn btn-blue" onclick="shareOrder(${i})">Share Order</button>
          <button class="btn btn-green" onclick="updatePasang(${i},'progres')">Progres</button>
          <button class="btn btn-green" onclick="updatePasang(${i},'active')">Active</button>
          <button class="btn btn-red" onclick="updatePasang(${i},'cancel')">Cancel</button>
        </td>
      </tr>`;
  });
}

function addPasang(){
  let nama = prompt("Nama:");
  let alamat = prompt("Alamat:");
  let hp = prompt("No HP:");
  let tagging = prompt("Tagging Lokasi:");
  let paket = prompt("Paket:");
  let p = {inputer:currentUser,nama,alamat,hp,tagging,paket,status:"menunggu"};
  pasangData.push(p);
  renderPasang();
}

function updatePasang(i,status){
  pasangData[i].status = status;
  renderPasang();
}

function shareOrder(i){
  let action = prompt("Teknisi: Ketik 'terima' untuk ambil order, 'tolak' untuk menolak:");
  if(action=="terima"){ pasangData[i].status = "progres"; }
  else if(action=="tolak"){ pasangData[i].status = "cancel"; }
  renderPasang();
}
</script>
</body>
</html>
