<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>ISP Manager System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {margin:0;font-family:sans-serif;background:#f4f6f9;}
    header {background:#2c3e50;color:#fff;padding:10px;display:flex;justify-content:space-between;align-items:center;}
    .sidebar {width:240px;background:#34495e;color:#fff;position:fixed;top:0;left:0;bottom:0;padding-top:60px;transition:.3s;}
    .sidebar.hide {left:-240px;}
    .sidebar a {display:block;padding:12px;color:#fff;text-decoration:none;}
    .sidebar a:hover {background:#1abc9c;}
    .content {margin-left:240px;padding:20px;transition:.3s;}
    .content.full {margin-left:0;}
    .card {background:#fff;padding:15px;margin-bottom:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);}
    .hidden {display:none;}
    table {width:100%;border-collapse:collapse;}
    table,th,td {border:1px solid #ddd;}
    th,td {padding:8px;text-align:left;}
    th {background:#2c3e50;color:#fff;}
    .btn {padding:5px 10px;border:none;border-radius:4px;cursor:pointer;}
    .btn-add {background:#27ae60;color:#fff;}
    .btn-edit {background:#f39c12;color:#fff;}
    .btn-del {background:#c0392b;color:#fff;}
    .topnav-btn {background:none;border:none;color:#fff;font-size:20px;cursor:pointer;}
    @media(max-width:768px){.content{margin-left:0}.sidebar{left:-240px}.sidebar.show{left:0}}
  </style>
</head>
<body>

<header>
  <button class="topnav-btn" onclick="toggleSidebar()">‚ò∞</button>
  <h2>ISP Manager</h2>
  <button onclick="logout()" class="btn-del">Logout</button>
</header>

<div class="sidebar hide" id="sidebar">
  <a href="#" onclick="showPage('dashboard')">üìä Dashboard</a>
  <a href="#" onclick="showPage('pelanggan')">üë• Pelanggan</a>
  <a href="#" onclick="showPage('pasangbaru')">‚ûï Pasang Baru</a>
  <a href="#" onclick="showPage('gangguan')">‚ö° Gangguan</a>
  <a href="#" onclick="showPage('material')">üì¶ Material</a>
  <a href="#" onclick="showPage('odp')">üóÇ ODP</a>
  <a href="#" onclick="showPage('mikrotik')">üåê Mikrotik</a>
  <a href="#" onclick="exportData()">‚¨á Export Data</a>
  <input type="file" onchange="importData(event)" />
</div>

<div class="content full" id="content">
  <!-- LOGIN -->
  <div id="loginPage">
    <div class="card">
      <h3>Login</h3>
      <input type="text" id="nik" placeholder="NIK"><br><br>
      <input type="password" id="password" placeholder="Password"><br><br>
      <button onclick="login()" class="btn-add">Login</button>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden">
    <h3>Dashboard</h3>
    <div class="card">Total Pelanggan: <span id="countPelanggan">0</span></div>
    <div class="card">Gangguan Aktif: <span id="countGangguan">0</span></div>
    <div class="card">Stok Material: <span id="countMaterial">0</span></div>
    <canvas id="chart" width="400" height="150"></canvas>
  </div>

  <!-- PELANGGAN -->
  <div id="pelanggan" class="hidden">
    <h3>Data Pelanggan</h3>
    <button class="btn btn-add" onclick="addPelanggan()">Tambah Pelanggan</button>
    <table>
      <thead><tr><th>Nama</th><th>No HP</th><th>Alamat</th><th>Paket</th><th>Aksi</th></tr></thead>
      <tbody id="pelangganTable"></tbody>
    </table>
  </div>

  <!-- PASANG BARU -->
  <div id="pasangbaru" class="hidden">
    <h3>Pasang Baru</h3>
    <button class="btn btn-add" onclick="addPasang()">Tambah Pasang Baru</button>
    <table>
      <thead><tr><th>No Internet</th><th>Nama</th><th>Alamat</th><th>Aksi</th></tr></thead>
      <tbody id="pasangTable"></tbody>
    </table>
  </div>

  <!-- GANGGUAN -->
  <div id="gangguan" class="hidden">
    <h3>Gangguan</h3>
    <button class="btn btn-add" onclick="addGangguan()">Tambah Gangguan</button>
    <table>
      <thead><tr><th>Tiket</th><th>Nama</th><th>Masalah</th><th>Status</th><th>Aksi</th></tr></thead>
      <tbody id="gangguanTable"></tbody>
    </table>
  </div>

  <!-- MATERIAL -->
  <div id="material" class="hidden">
    <h3>Material</h3>
    <button class="btn btn-add" onclick="addMaterial()">Tambah Material</button>
    <table>
      <thead><tr><th>Nama Material</th><th>Stok</th><th>Aksi</th></tr></thead>
      <tbody id="materialTable"></tbody>
    </table>
  </div>

  <!-- ODP -->
  <div id="odp" class="hidden">
    <h3>ODP</h3>
    <button class="btn btn-add" onclick="addODP()">Tambah ODP</button>
    <table>
      <thead><tr><th>Kode ODP</th><th>Lokasi</th><th>Port</th><th>Aksi</th></tr></thead>
      <tbody id="odpTable"></tbody>
    </table>
  </div>

  <!-- MIKROTIK -->
  <div id="mikrotik" class="hidden">
    <h3>Mikrotik</h3>
    <button class="btn btn-add" onclick="addMikrotik()">Tambah Router</button>
    <table>
      <thead><tr><th>Nama Router</th><th>IP</th><th>User</th><th>Aksi</th></tr></thead>
      <tbody id="mikrotikTable"></tbody>
    </table>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
let userDefault = {nik:"12345",password:"admin"};
let data = JSON.parse(localStorage.getItem("ispData"))||{pelanggan:[],pasang:[],gangguan:[],material:[],odp:[],mikrotik:[]};

function save(){localStorage.setItem("ispData",JSON.stringify(data));updateDashboard();}
function toggleSidebar(){document.getElementById("sidebar").classList.toggle("show");}
function showPage(id){document.querySelectorAll(".content>div").forEach(d=>d.classList.add("hidden"));document.getElementById(id).classList.remove("hidden");document.getElementById("sidebar").classList.add("hide");}
function login(){let nik=document.getElementById("nik").value;let pw=document.getElementById("password").value;if(nik===userDefault.nik&&pw===userDefault.password){document.getElementById("loginPage").classList.add("hidden");showPage("dashboard");updateAll();}else{alert("Login gagal!");}}
function logout(){location.reload();}

// CRUD Pelanggan
function addPelanggan(){let nama=prompt("Nama");if(!nama)return;let hp=prompt("No HP");let al=prompt("Alamat");let paket=prompt("Paket");data.pelanggan.push({nama,hp,al,paket});save();renderPelanggan();}
function renderPelanggan(){let t=document.getElementById("pelangganTable");t.innerHTML="";data.pelanggan.forEach((p,i)=>{t.innerHTML+=`<tr><td>${p.nama}</td><td>${p.hp}</td><td>${p.al}</td><td>${p.paket}</td><td><button class='btn btn-del' onclick='delPelanggan(${i})'>Hapus</button></td></tr>`});}
function delPelanggan(i){data.pelanggan.splice(i,1);save();renderPelanggan();}

// Pasang Baru
function addPasang(){let nama=prompt("Nama");if(!nama)return;let al=prompt("Alamat");let no="INET"+String(data.pasang.length+1).padStart(4,"0");data.pasang.push({no,nama,al});save();renderPasang();}
function renderPasang(){let t=document.getElementById("pasangTable");t.innerHTML="";data.pasang.forEach((p,i)=>{t.innerHTML+=`<tr><td>${p.no}</td><td>${p.nama}</td><td>${p.al}</td><td><button class='btn btn-del' onclick='delPasang(${i})'>Hapus</button></td></tr>`});}
function delPasang(i){data.pasang.splice(i,1);save();renderPasang();}

// Gangguan
function addGangguan(){let nama=prompt("Nama");if(!nama)return;let masalah=prompt("Masalah");let tiket="TC"+String(data.gangguan.length+1).padStart(4,"0");data.gangguan.push({tiket,nama,masalah,status:"Menunggu"});save();renderGangguan();}
function renderGangguan(){let t=document.getElementById("gangguanTable");t.innerHTML="";data.gangguan.forEach((g,i)=>{t.innerHTML+=`<tr><td>${g.tiket}</td><td>${g.nama}</td><td>${g.masalah}</td><td>${g.status}</td><td><button class='btn btn-edit' onclick='progressGangguan(${i})'>Progres</button><button class='btn btn-del' onclick='delGangguan(${i})'>Hapus</button></td></tr>`});}
function progressGangguan(i){data.gangguan[i].status="Selesai";save();renderGangguan();}
function delGangguan(i){data.gangguan.splice(i,1);save();renderGangguan();}

// Material
function addMaterial(){let nama=prompt("Material");if(!nama)return;let stok=prompt("Stok");data.material.push({nama,stok});save();renderMaterial();}
function renderMaterial(){let t=document.getElementById("materialTable");t.innerHTML="";data.material.forEach((m,i)=>{t.innerHTML+=`<tr><td>${m.nama}</td><td>${m.stok}</td><td><button class='btn btn-del' onclick='delMaterial(${i})'>Hapus</button></td></tr>`});}
function delMaterial(i){data.material.splice(i,1);save();renderMaterial();}

// ODP
function addODP(){let kode=prompt("Kode ODP");if(!kode)return;let lokasi=prompt("Lokasi");let port=prompt("Port");data.odp.push({kode,lokasi,port});save();renderODP();}
function renderODP(){let t=document.getElementById("odpTable");t.innerHTML="";data.odp.forEach((o,i)=>{t.innerHTML+=`<tr><td>${o.kode}</td><td>${o.lokasi}</td><td>${o.port}</td><td><button class='btn btn-del' onclick='delODP(${i})'>Hapus</button></td></tr>`});}
function delODP(i){data.odp.splice(i,1);save();renderODP();}

// Mikrotik
function addMikrotik(){let nama=prompt("Nama Router");if(!nama)return;let ip=prompt("IP");let user=prompt("User");data.mikrotik.push({nama,ip,user});save();renderMikrotik();}
function renderMikrotik(){let t=document.getElementById("mikrotikTable");t.innerHTML="";data.mikrotik.forEach((m,i)=>{t.innerHTML+=`<tr><td>${m.nama}</td><td>${m.ip}</td><td>${m.user}</td><td><button class='btn btn-del' onclick='delMikrotik(${i})'>Hapus</button></td></tr>`});}
function delMikrotik(i){data.mikrotik.splice(i,1);save();renderMikrotik();}

// Dashboard update
function updateDashboard(){document.getElementById("countPelanggan").innerText=data.pelanggan.length;document.getElementById("countGangguan").innerText=data.gangguan.filter(g=>g.status!="Selesai").length;let stok=0;data.material.forEach(m=>stok+=parseInt(m.stok||0));document.getElementById("countMaterial").innerText=stok;drawChart();}
function drawChart(){let ctx=document.getElementById("chart");new Chart(ctx,{type:'bar',data:{labels:["Pelanggan","Gangguan","Material"],datasets:[{label:"Statistik",data:[data.pelanggan.length,data.gangguan.length,data.material.length]}]}});}

// Export Import
function exportData(){let blob=new Blob([JSON.stringify(data)],{type:"application/json"});let a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download="ispdata.json";a.click();}
function importData(e){let f=e.target.files[0];let r=new FileReader();r.onload=function(){data=JSON.parse(r.result);save();updateAll();};r.readAsText(f);}

// init
function updateAll(){renderPelanggan();renderPasang();renderGangguan();renderMaterial();renderODP();renderMikrotik();updateDashboard();}
</script>
</body>
</html>
