<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ISP Management - Final</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { font-family: Arial, sans-serif; background: #f8f9fa; }
    .navbar { background: #0d6efd; }
    .navbar .navbar-brand, .nav-link { color: #fff !important; }
    .sidebar { min-width: 220px; max-width: 220px; }
    .card { border-radius: 8px; margin-bottom: 12px; }
    .content-area { padding: 15px; }

    /* Settings Panel */
    .settings-panel {
      position: fixed;
      left: 50%;
      top: 50px;
      transform: translateX(-50%);
      width: 96%;
      max-width: 1200px;
      height: 85vh;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 28px rgba(0,0,0,0.25);
      display: none;
      z-index: 2000;
      overflow: hidden;
    }
    .settings-inner { display: flex; height: 100% }
    .settings-sidebar {
      width: 250px;
      background: #f1f5f9;
      padding: 14px;
      border-right: 1px solid #ddd;
      overflow: auto
    }
    .settings-sidebar button {
      display: block;
      width: 100%;
      text-align: left;
      padding: 10px;
      border: none;
      background: none;
      border-radius: 6px;
      margin-bottom: 6px;
      cursor: pointer
    }
    .settings-sidebar button.active { background:#0d6efd;color:#fff }
    .settings-body { flex:1; padding:16px; overflow:auto }
    @media(max-width:800px){
      .settings-inner{flex-direction:column}
      .settings-sidebar{width:100%;display:flex;overflow-x:auto}
      .settings-sidebar button{flex:1;text-align:center}
    }
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Starnet ISP</a>
    <button class="btn btn-light" onclick="openSettings()">⚙️ Pengaturan</button>
  </div>
</nav>

<div class="container-fluid mt-3">
  <div class="row">
    <div class="col-md-3 sidebar">
      <div class="card p-2">
        <h6>Menu</h6>
        <ul class="nav flex-column">
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('dashboard')">Dashboard</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('billing')">Billing</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('pelanggan')">Pelanggan</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('pasang')">Pasang Baru</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('gangguan')">Gangguan</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('kas')">Kas</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('odp')">ODP</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('material')">Material</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('paket')">Paket</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('mikrotik')">Mikrotik</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('shared')">Shared</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('history')">History</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('feedback')">Feedback</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('portal')">Portal</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('reports')">Reports</a></li>
          <li class="nav-item"><a href="#" class="nav-link" onclick="showPage('users')">Users</a></li>
        </ul>
      </div>
    </div>
    <div class="col-md-9">
      <div id="dashboard" class="content-area card">
        <h4>Dashboard</h4>
        <p>Konten dashboard asli…</p>
      </div>
      <div id="billing" class="content-area card d-none">
        <h4>Billing</h4>
        <div id="billingList"></div>
      </div>
      <div id="pelanggan" class="content-area card d-none">
        <h4>Data Pelanggan</h4>
        <p>Konten asli pelanggan…</p>
      </div>
      <div id="pasang" class="content-area card d-none">
        <h4>Pasang Baru</h4>
        <p>Form pasang baru asli…</p>
      </div>
      <div id="gangguan" class="content-area card d-none">
        <h4>Gangguan</h4>
        <p>Data gangguan asli…</p>
      </div>
      <div id="kas" class="content-area card d-none">
        <h4>Kas</h4>
      </div>
      <div id="odp" class="content-area card d-none">
        <h4>ODP</h4>
      </div>
      <div id="material" class="content-area card d-none">
        <h4>Material</h4>
      </div>
      <div id="paket" class="content-area card d-none">
        <h4>Paket</h4>
      </div>
      <div id="mikrotik" class="content-area card d-none">
        <h4>Mikrotik</h4>
      </div>
      <div id="shared" class="content-area card d-none">
        <h4>Shared</h4>
      </div>
      <div id="history" class="content-area card d-none">
        <h4>History</h4>
      </div>
      <div id="feedback" class="content-area card d-none">
        <h4>Feedback</h4>
      </div>
      <div id="portal" class="content-area card d-none">
        <h4>Portal</h4>
      </div>
      <div id="reports" class="content-area card d-none">
        <h4>Reports</h4>
      </div>
      <div id="users" class="content-area card d-none">
        <h4>Users</h4>
      </div>
    </div>
  </div>
</div>
<!-- PANEL PENGATURAN -->
<div id="settingsPanel" class="settings-panel">
  <div class="settings-inner">
    <div class="settings-sidebar">
      <button id="btnProfile" class="active" onclick="showSettings('profile')">Profile ISP</button>
      <button id="btnWA" onclick="showSettings('wa')">API WhatsApp</button>
      <button id="btnTG" onclick="showSettings('tg')">API Telegram</button>
      <button id="btnMK" onclick="showSettings('mikrotik')">Mikrotik</button>
      <button id="btnStruk" onclick="showSettings('struk')">Customize Struk</button>
      <button id="btnBill" onclick="showSettings('billing')">Billing</button>
    </div>
    <div class="settings-body">
      <!-- Profile -->
      <div id="set-profile">
        <h4>Profile ISP</h4>
        <form>
          <div class="mb-2"><label>Logo ISP</label><input type="file" class="form-control"></div>
          <div class="mb-2"><label>Nama ISP</label><input type="text" class="form-control" value="Starnet ISP"></div>
          <div class="mb-2"><label>Alamat</label><input type="text" class="form-control"></div>
          <div class="mb-2"><label>No. HP</label><input type="text" class="form-control"></div>
          <div class="mb-2"><label>No. Telp</label><input type="text" class="form-control"></div>
          <div class="mb-2"><label>Email</label><input type="email" class="form-control"></div>
          <button class="btn btn-primary">Simpan</button>
        </form>
      </div>
      <!-- WA -->
      <div id="set-wa" style="display:none">
        <h4>API WhatsApp</h4>
        <form>
          <div class="mb-2"><label>Nomor WA</label><input type="text" class="form-control" value="+6281336652986"></div>
          <div class="mb-2"><label>API Key</label><input type="text" class="form-control"></div>
          <button class="btn btn-success">Simpan</button>
        </form>
      </div>
      <!-- TG -->
      <div id="set-tg" style="display:none">
        <h4>API Telegram</h4>
        <form>
          <div class="mb-2"><label>Bot Token</label><input type="text" class="form-control"></div>
          <div class="mb-2"><label>Chat ID</label><input type="text" class="form-control"></div>
          <button class="btn btn-success">Simpan</button>
        </form>
      </div>
      <!-- Mikrotik -->
      <div id="set-mikrotik" style="display:none">
        <h4>Integrasi Mikrotik</h4>
        <form>
          <div class="mb-2"><label>Host/IP</label><input type="text" class="form-control"></div>
          <div class="mb-2"><label>User</label><input type="text" class="form-control"></div>
          <div class="mb-2"><label>Password</label><input type="password" class="form-control"></div>
          <button class="btn btn-warning">Test Koneksi</button>
        </form>
      </div>
      <!-- Struk -->
      <div id="set-struk" style="display:none">
        <h4>Customize Struk</h4>
        <div class="d-flex gap-3">
          <div><img src="https://via.placeholder.com/320x200?text=Default" width="120"><div><input type="radio" name="theme" checked> Default</div></div>
          <div><img src="https://via.placeholder.com/320x200?text=Kwitansi" width="120"><div><input type="radio" name="theme"> Kwitansi</div></div>
          <div><img src="https://via.placeholder.com/320x200?text=Minimalis" width="120"><div><input type="radio" name="theme"> Minimalis</div></div>
        </div>
        <div class="mt-2"><label>Editor Template</label><textarea class="form-control" rows="6"></textarea></div>
        <button class="btn btn-info mt-2">Simpan</button>
      </div>
      <!-- Billing -->
      <div id="set-billing" style="display:none">
        <h4>Pengaturan Billing</h4>
        <form>
          <div class="mb-2"><label>Mode Billing</label>
            <select class="form-control">
              <option>Prabayar</option>
              <option>Pascabayar</option>
            </select>
          </div>
          <button class="btn btn-success">Simpan</button>
        </form>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
function showPage(id){
  document.querySelectorAll('.content-area').forEach(e=>e.classList.add('d-none'));
  var el=document.getElementById(id);
  if(el) el.classList.remove('d-none');
}
function openSettings(){document.getElementById('settingsPanel').style.display='block';}
function showSettings(tab){
  document.querySelectorAll('.settings-body>div').forEach(el=>el.style.display='none');
  document.querySelectorAll('.settings-sidebar button').forEach(b=>b.classList.remove('active'));
  var s=document.getElementById('set-'+tab);
  if(s) s.style.display='block';
  var btn=document.getElementById('btn'+tab.charAt(0).toUpperCase()+tab.slice(1));
  if(btn) btn.classList.add('active');
}
// Dummy pelanggan untuk test invoice
const pelanggan=[
{id:1,nama:"Andi",paket:"Basic",wa:"+6281336652986"},
{id:2,nama:"Budi",paket:"Premium",wa:"+6281336652986"},
{id:3,nama:"Cici",paket:"Basic",wa:"+6281336652986"},
{id:4,nama:"Dodi",paket:"Gold",wa:"+6281336652986"},
{id:5,nama:"Eka",paket:"Basic",wa:"+6281336652986"},
{id:6,nama:"Feri",paket:"Premium",wa:"+6281336652986"},
{id:7,nama:"Gina",paket:"Basic",wa:"+6281336652986"},
{id:8,nama:"Hani",paket:"Gold",wa:"+6281336652986"},
{id:9,nama:"Indra",paket:"Basic",wa:"+6281336652986"},
{id:10,nama:"Joko",paket:"Premium",wa:"+6281336652986"}
];
function renderBilling(){
 let c=document.getElementById('billingList'); if(!c) return; c.innerHTML="";
 pelanggan.forEach(p=>{
   c.innerHTML+=`<div class="card p-2 mb-2">
     <div><b>${p.nama}</b> - Paket: ${p.paket}</div>
     <div>WA: ${p.wa}</div>
     <button class="btn btn-primary btn-sm" onclick="openPembayaran(${p.id})">Bayar</button>
     <button class="btn btn-success btn-sm" onclick="kirimInvoice(${p.id})">Kirim Invoice</button>
   </div>`;
 });
}
renderBilling();
function openPembayaran(id){
 const modal=document.createElement('div');
 modal.className='modal fade show';modal.style.display='block';
 modal.innerHTML=`<div class="modal-dialog"><div class="modal-content p-3">
   <h5>Pembayaran</h5>
   <label>Periode Pemakaian</label><input id="periodeInput" class="form-control mb-2" placeholder="Pilih tanggal mulai - akhir">
   <div style="display:flex;gap:8px;margin-top:8px">
     <input id="p_start" type="date" class="form-control">
     <input id="p_end" type="date" class="form-control">
   </div>
   <div style="margin-top:10px;display:flex;gap:8px">
     <button class="btn btn-success" onclick="prosesBayar(${id})">Bayar</button>
     <button class="btn btn-secondary" onclick="this.closest('.modal').remove()">Batal</button>
   </div>
 </div></div>`;
 document.body.appendChild(modal);
 try{ flatpickr("#periodeInput",{mode:'range',dateFormat:"d-m-Y"}); }catch(e){}
}
function prosesBayar(id){ alert("Pembayaran pelanggan "+id+" sukses"); document.querySelectorAll('.modal').forEach(m=>m.remove()); }
function kirimInvoice(id){
 const p=pelanggan.find(x=>x.id===id);
 if(!p){ alert('Pelanggan tidak ditemukan'); return; }
 // Simulasi kirim WA (tidak mengirim sebenarnya)
 alert("Invoice terkirim (simulasi) ke "+p.wa+" untuk "+p.nama+" paket "+p.paket);
}
// ===== INJECTION (assistant) START =====
<!-- INJECT_SETTINGS_START -->
<!-- Settings + Struk injection by assistant -->
<script>console.log('Injection placeholder');</script>
<!-- INJECT_SETTINGS_END -->
// ===== INJECTION (assistant) END =====
</script>
</body>
</html>
